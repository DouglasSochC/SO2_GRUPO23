#!/usr/bin/stap

probe begin {
    printf("[%s] Iniciando Monitoreo\n", ctime(gettimeofday_s()));
}

probe syscall.read {
    if(pid() == $1 || pid() == $2){
        printf("[%s] PID[%d] %s -> Read\n", ctime(gettimeofday_s()), pid(), execname());
    }
}

probe syscall.write {
    if(pid() == $1 || pid() == $2){
        printf("[%s] PID[%d] %s -> Write\n", ctime(gettimeofday_s()), pid(), execname());
    }
}